

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MSM (Markov State Model) &mdash; FSATOOL 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Transform" href="transform.html" />
    <link rel="prev" title="MSM module" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> FSATOOL
          

          
            
            <img src="../_static/fsatool_logo.jpg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../SamplingModule/index.html">Sampling module</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">MSM module</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">MSM (Markov State Model)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#msm-namelist">msm namelist</a></li>
<li class="toctree-l3"><a class="reference internal" href="#trajs-namelist">trajs namelist</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-file-format">Input File Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-file">Output File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-the-msm-command">Run the msm command</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="transform.html">Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="check.html">Check</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster.html">Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="lumping.html">Lumping</a></li>
<li class="toctree-l2"><a class="reference internal" href="tpt.html">TPT</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Extractmodule.html">Extract trajectory module</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Visualization.html">Visualization</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Reference.html">Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">FSATOOL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">MSM module</a> &raquo;</li>
        
      <li>MSM (Markov State Model)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/MSMmodule/msm.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="msm-markov-state-model">
<h1>MSM (Markov State Model)<a class="headerlink" href="#msm-markov-state-model" title="Permalink to this headline">¶</a></h1>
<p>This module runs MSM, which contains three steps: clustering, lumping and transition path analyzing It contains the <em>msm</em>, <em>trajs</em> namelist.</p>
<div class="section" id="msm-namelist">
<h2>msm namelist<a class="headerlink" href="#msm-namelist" title="Permalink to this headline">¶</a></h2>
<p>The <em>msm</em> namelist has following parameters</p>
<p>Necessary Parameters</p>
<hr class="docutils" />
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">ndim</dt>
<dd class="field-odd"><p><strong>integer</strong> The CV dimension or the atom’s dimension.  When the <em>clustermethod</em> is “coordinate”, the <em>ndim</em> must equal to atom * 3. And when other cluster method is used, the <em>ndim</em> must be the <em>ncv</em></p>
</dd>
<dt class="field-even">ncluster</dt>
<dd class="field-even"><p><strong>integer</strong> The number of microstates(cluster number) to run cluster</p>
</dd>
<dt class="field-odd">lagstep</dt>
<dd class="field-odd"><p><strong>integer</strong>  The lag step of building msm</p>
</dd>
<dt class="field-even">nstate</dt>
<dd class="field-even"><p><strong>integer</strong> The number of macrostates to do the coarse grain</p>
</dd>
<dt class="field-odd">ifreadcoor</dt>
<dd class="field-odd"><p><strong>logical</strong> If true, read the trajs from &amp;traj namelist; if false, read the information from the cluster result</p>
</dd>
<dt class="field-even">startstate</dt>
<dd class="field-even"><p><strong>integer</strong> The index of start state of runing TPT analysis</p>
</dd>
<dt class="field-odd">endstate</dt>
<dd class="field-odd"><p><strong>integer</strong> The index of end state of runing TPT analysis</p>
</dd>
</dl>
</div></blockquote>
<p>Optional Parameters</p>
<hr class="docutils" />
<blockquote>
<div><dl class="field-list">
<dt class="field-odd">clustermethod</dt>
<dd class="field-odd"><p><strong>character</strong> The cluster method. Default cluster method is “kmeans++”  <a class="reference internal" href="../Reference.html#arthur2007k" id="id1">[AV07]</a>, the other method “kmedoids” <a class="reference internal" href="../Reference.html#park2009simple" id="id2">[PJ09]</a>, “coordinate” is supported. When the “coordinate” method is used, the <em>coorfiles</em> in <em>trajs</em> namelist AMBER NETCDF format must be provided.</p>
</dd>
<dt class="field-even">clustercycle</dt>
<dd class="field-even"><p><strong>integer</strong> The maximum number of iteration to perform cluster. Default number is 600.</p>
</dd>
<dt class="field-odd">cutnumber</dt>
<dd class="field-odd"><p><strong>integer</strong> Strip the cluster which has number less than the cutnumber. Default is zero which means doesn’t strip any cluster.</p>
</dd>
<dt class="field-even">lumpingmethod</dt>
<dd class="field-even"><p><strong>character</strong> The lumping method to do the coarse grain. Default method is “pccaplus” <a class="reference internal" href="../Reference.html#roblitz2013fuzzy" id="id3">[RoblitzW13]</a>. The “bace” method <a class="reference internal" href="../Reference.html#bowman2012" id="id4">[Bow12]</a> is supported.</p>
</dd>
<dt class="field-odd">tpmmethod</dt>
<dd class="field-odd"><p><strong>character</strong> The method of how to build the MSM microstate transition matrix. Default method is “reversible”, which use the maximum likelihood probability method <a class="reference internal" href="../Reference.html#bowman2009" id="id5">[BBBP09]</a>. The other method, “normal” simpliy count the transition times from a cluster to another cluster divided by the counts in the cluster. The “non-reversible” method aggregates counts from cluster <em>i</em> to cluster <em>j</em> and counts from cluster <em>j</em> to cluster <em>i</em>. The total counts then divided by 2 and counts in the cluster. The code of this process shows below:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="p">(</span><span class="n">tcm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">tcm</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span><span class="o">*</span><span class="mf">0.5d0</span>
<span class="n">tpm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">tcm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">:))</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="trajs-namelist">
<h2>trajs namelist<a class="headerlink" href="#trajs-namelist" title="Permalink to this headline">¶</a></h2>
<p>Specify the parameters for input trajectory</p>
<p>Necessary Parameters</p>
<hr class="docutils" />
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">ncv</dt>
<dd class="field-odd"><p><strong>integer</strong> The dimension of collective variables in the input trajectory.</p>
</dd>
<dt class="field-even">cvsfiles</dt>
<dd class="field-even"><p><strong>array of character</strong> The input files of the collective variables. The order of file must follow the increased temperature.</p>
</dd>
<dt class="field-odd">kelvinarray</dt>
<dd class="field-odd"><p><strong>array of double precision</strong> If the <em>kelvinarray</em> parameter has only one value, then all the input file has same temperature. If the <em>kelevinarray</em> parameter has multiple values, then the <em>numFileLevel</em> parameter must be specifed</p>
</dd>
</dl>
</div></blockquote>
<p>Optional Parameters</p>
<hr class="docutils" />
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">numFileLevel</dt>
<dd class="field-odd"><p><strong>array of integer</strong> If the <em>kelvinarray</em> has only one value, then this parameter dosen’t need to be specifed. Else, the number of file in each temperature needs to be declared.</p>
</dd>
<dt class="field-even">coorfiles</dt>
<dd class="field-even"><p><strong>array of character</strong> The input file of the atom’s coordinate.</p>
</dd>
<dt class="field-odd">trajtype</dt>
<dd class="field-odd"><p><strong>integer</strong> This variable specify the type of trajectory. Default value is 0, and the <em>coorfiles</em> doesn’t need to be specified. When the trajectory type is 1, the format must be the same as amber trajectory file. And when the trajectory type is 2, the format has to be the AMBER NETCDF trajectory.</p>
</dd>
<dt class="field-even">framestride</dt>
<dd class="field-even"><p><strong>integer</strong>  The frame stride of trajectory to be read into the MSM. Default value is 1. When the length of the CVs is not same as the <em>coorfiles</em>, and using the “coordinate” cluster method, this value must be specified and it’s equal to the length of the “coorfiles” divided by the length of the CV.</p>
</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>The example of input file for MSM analyze shows below</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">msm</span>
    <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">ncluster</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">lagstep</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">nstate</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">ifreadcoor</span><span class="o">=.</span><span class="n">true</span><span class="o">.</span>
    <span class="n">startstate</span> <span class="o">=</span><span class="mi">10</span>
    <span class="n">endstate</span> <span class="o">=</span> <span class="mi">8</span>
<span class="o">/</span>

<span class="o">&amp;</span><span class="n">trajs</span>
    <span class="n">ncv</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">kelvinarray</span><span class="o">=</span><span class="mi">300</span>
    <span class="n">cvsfiles</span><span class="o">=</span><span class="s2">&quot;sim1/cvfile&quot;</span><span class="p">,</span> <span class="s2">&quot;sim2/cvfile&quot;</span>
    <span class="n">coorfiles</span> <span class="o">=</span> <span class="s2">&quot;sim1/mdcrd.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;sim2/mdcrd.nc&quot;</span>
    <span class="n">trajtype</span> <span class="o">=</span> <span class="mi">2</span>
<span class="o">/</span>
</pre></div>
</div>
</div>
<div class="section" id="input-file-format">
<h2>Input File Format<a class="headerlink" href="#input-file-format" title="Permalink to this headline">¶</a></h2>
<p>In the <em>trajs</em> namelist, we need to specify the collective variables files. The format of file shows below</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 39%" />
<col style="width: 14%" />
<col style="width: 18%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>traj index</p></th>
<th class="head"><p>cv 1</p></th>
<th class="head"><p>cv 2</p></th>
<th class="head"><p>cv …</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>0.2</p></td>
<td><p>22.3</p></td>
<td><p>15.2 …</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>0.3</p></td>
<td><p>22.4</p></td>
<td><p>19.2 …</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>0.21</p></td>
<td><p>22.5</p></td>
<td><p>23.2 …</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>0.22</p></td>
<td><p>23.3</p></td>
<td><p>24.2 …</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>0.23</p></td>
<td><p>24.3</p></td>
<td><p>26.2 …</p></td>
</tr>
<tr class="row-odd"><td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…  …</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><strong>traj index</strong> : <em>integer</em> Specify the trajectory index. When the trajectory is break at certain point, the <em>traj index</em> must be changed, the same index means the continuous trajectory.</p></li>
<li><p><strong>cv</strong> : <em>double precision</em>  The collective variables</p></li>
</ul>
</div>
<div class="section" id="output-file">
<h2>Output File<a class="headerlink" href="#output-file" title="Permalink to this headline">¶</a></h2>
<p>After running MSM, there are several output files. There are putting into the “info” directory</p>
<ol class="arabic simple">
<li><p><em>clusters.txt</em> This file specify the cluster result. It has the following format:</p></li>
</ol>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 28%" />
<col style="width: 21%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>frame index</p></th>
<th class="head"><p>cluster index</p></th>
<th class="head"><p>traj index</p></th>
<th class="head"><p>CV 1</p></th>
<th class="head"><p>CV 2</p></th>
<th class="head"><p>…</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2922</p></td>
<td><p>1</p></td>
<td><p>971</p></td>
<td><p>14.5</p></td>
<td><p>6.50</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>2963</p></td>
<td><p>1</p></td>
<td><p>971</p></td>
<td><p>14.7</p></td>
<td><p>6.51</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>3024</p></td>
<td><p>1</p></td>
<td><p>990</p></td>
<td><p>14.3</p></td>
<td><p>6.46</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>3046</p></td>
<td><p>1</p></td>
<td><p>990</p></td>
<td><p>14.6</p></td>
<td><p>6.57</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>3047</p></td>
<td><p>1</p></td>
<td><p>990</p></td>
<td><p>14.4</p></td>
<td><p>6.60</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>3089</p></td>
<td><p>1</p></td>
<td><p>1018</p></td>
<td><p>14.4</p></td>
<td><p>6.32</p></td>
<td><p>…</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><ul class="simple">
<li><p><strong>frame index</strong> : frame index</p></li>
<li><p><strong>cluster index</strong> : cluster index of the frame belong to</p></li>
<li><p><strong>traj index</strong> : trajectory index</p></li>
<li><p><strong>CV</strong>: collective variables variables</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p><em>clusterindex.txt</em> cluster result, the header of three numbers specify the number of cluster, the number of frames. This file needs <em>clusters.txt</em> to get a complete result</p></li>
</ol>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 13%" />
<col style="width: 21%" />
<col style="width: 26%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>cluster index</p></th>
<th class="head"><p>end frames</p></th>
<th class="head"><p>number of frames</p></th>
<th class="head"><p>center cluster index</p></th>
<th class="head"><p>center cluster cv</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1416</p></td>
<td><p>1416</p></td>
<td><p>9446</p></td>
<td><p>14.6190,   6.499</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>1507</p></td>
<td><p>91</p></td>
<td><p>133288</p></td>
<td><p>20.4610,  19.542</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>1671</p></td>
<td><p>164</p></td>
<td><p>124050</p></td>
<td><p>2.98000,  23.116</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>2301</p></td>
<td><p>630</p></td>
<td><p>167108</p></td>
<td><p>9.95400,  10.602</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>2852</p></td>
<td><p>551</p></td>
<td><p>110019</p></td>
<td><p>4.71500,  15.760</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>3236</p></td>
<td><p>384</p></td>
<td><p>121381</p></td>
<td><p>9.30700,  15.891</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><ul class="simple">
<li><p><strong>cluster index</strong> : cluster  index</p></li>
<li><p><strong>end frames</strong> : the end frame index of this cluster. For example, in the table above, the cluster index 1 has the frame index of 1-1416. The cluster index 4 has the frame index 1672-2301. The start (i) and end (j) frame index correspond to the ith line and jth line in the <em>clusters.txt</em> file</p></li>
<li><p><strong>number of frames</strong> : number of frames in this cluster</p></li>
<li><p><strong>center cluster index</strong> : center cluster index</p></li>
<li><p><strong>center cluster cv</strong> : center cluster collective variable coordinates</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p><em>cluster_forcheck.txt</em>: Input file for computing timescales on each lagstep upon the cluster result.</p></li>
</ol>
<table class="docutils align-default">
<colgroup>
<col style="width: 57%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>cluster index</p></th>
<th class="head"><p>traj index</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>17</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>17</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>17</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>30</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>30</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><ul class="simple">
<li><p><strong>cluster index</strong> : cluster index</p></li>
<li><p><strong>traj index</strong>    : trajectory index</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p><em>states.txt</em>: Coarse grain results</p></li>
</ol>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 19%" />
<col style="width: 39%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>state index</p></th>
<th class="head"><p>cluster index</p></th>
<th class="head"><p>center cluster frame index</p></th>
<th class="head"><p>center cluster cv</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>107</p></td>
<td><p>191218</p></td>
<td><p>27.774,  2.581</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>284</p></td>
<td><p>266</p></td>
<td><p>26.188 , 1.474</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>2</p></td>
<td><p>133288</p></td>
<td><p>20.461, 19.542</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>89</p></td>
<td><p>136689</p></td>
<td><p>18.140,  16.989</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>123</p></td>
<td><p>136208</p></td>
<td><p>21.756, 15.047</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>159</p></td>
<td><p>135510</p></td>
<td><p>21.781,  12.424</p></td>
</tr>
</tbody>
</table>
<p>5. <em>stateindex.txt</em> Coarse grain results, combine with the <em>states.txt</em> file to get a complete result.
The header of three numbers specify the state number, cluster number and snapshot number</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 15%" />
<col style="width: 18%" />
<col style="width: 15%" />
<col style="width: 14%" />
<col style="width: 11%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>state index</p></th>
<th class="head"><p>end state index</p></th>
<th class="head"><p>number of cluster</p></th>
<th class="head"><p>number of snaps</p></th>
<th class="head"><p>center cluster</p></th>
<th class="head"><p>center snap</p></th>
<th class="head"><p>center snap cv</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>13</p></td>
<td><p>13</p></td>
<td><p>7435</p></td>
<td><p>555</p></td>
<td><p>150056</p></td>
<td><p>5.002   2.181</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>33</p></td>
<td><p>20</p></td>
<td><p>8096</p></td>
<td><p>175</p></td>
<td><p>694789</p></td>
<td><p>18.760   1.198</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>52</p></td>
<td><p>19</p></td>
<td><p>10437</p></td>
<td><p>662</p></td>
<td><p>651615</p></td>
<td><p>19.193   2.201</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>69</p></td>
<td><p>17</p></td>
<td><p>19840</p></td>
<td><p>469</p></td>
<td><p>317123</p></td>
<td><p>4.558   1.764</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>123</p></td>
<td><p>54</p></td>
<td><p>37105</p></td>
<td><p>633</p></td>
<td><p>23469</p></td>
<td><p>10.842   0.957</p></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="6">
<li><p><em>marco_net_flux.txt</em> Transition path theory results, it’s the net flux matrix from start state to end state which has a form of (number of state * number of state)</p></li>
</ol>
</div>
<div class="section" id="run-the-msm-command">
<h2>Run the msm command<a class="headerlink" href="#run-the-msm-command" title="Permalink to this headline">¶</a></h2>
<p>Default input file is “msm.in”，and default output directory is “info/”.
The user can provide the input file by <cite>-i</cite> with input file, and <cite>-o</cite> with output directory. The program run <cite>msm</cite> default.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./msm.x
./msm.x msm
./msm.x msm -i msm.in -o msm_result
mpirun -n <span class="m">4</span> ./msm.x
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="transform.html" class="btn btn-neutral float-right" title="Transform" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="MSM module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, FSATOOL Group

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>